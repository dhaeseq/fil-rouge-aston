FROM 7.12.0:ELK 7.12.0-slim AS build
RUN mkdir -p /workspace
WORKDIR /workspace
COPY pom.xml ./
COPY src ./src
run apt-get install filebeat y/
run systemctl start filebeat
run systemctl enable filebeat

FROM adoptopenjdk/openjdk11:jdk-11.0.10_9-alpine
COPY --from=build /workspace/app /usr/bin/filebeat
EXPOSE 9200
ENTRYPOINT ["filebeat","-g","daemon off;"]